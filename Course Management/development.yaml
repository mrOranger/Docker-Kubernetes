version: '3.8'
name: course-management

services:
    cache:
        image: redis
        container_name: cache
        ports:
            - 6000:6379
        networks:
            - course-management-network

    student-database:
        container_name: student-database
        build:
            context: ./databases/student
            dockerfile: database.dockerfile
        ports:
            - 3002:3306
        env_file:
            - ./databases/student/.env
        networks:
            - course-management-network
        volumes:
            - database-student-volume:/var/lib/mysql

    student-service:
        container_name: student-service
        build:
            context: ./services/student
            dockerfile: development.dockerfile
        ports:
            - 8000:80
        env_file:
            - ./services/student/.env
        networks:
            - course-management-network
        volumes:
            - ./services/student:/var/www
            - students-node-module:/var/www/node_modules
        depends_on:
            - cache
            - student-database
networks:
    course-management-network:
        driver: bridge

volumes:
    students-node-module:
    database-student-volume:
